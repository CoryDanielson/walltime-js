(function(){var e,t,n,r,i;e={DayShortNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],DayIndex:function(e){return this.DayShortNames.indexOf(e)},DayNameFromIndex:function(e){return this.DayShortNames[e]},AddToDate:function(e,n){return r.MakeDateFromTimeStamp(e.getTime()+n*t.inDay)}},n={MonthsShortNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],MonthIndex:function(e){return this.MonthsShortNames.indexOf(e.slice(0,3))}},t={inDay:864e5,inHour:36e5,inMinute:6e4,inSecond:1e3},r={ParseGMTOffset:function(e){var t,n,r,i,s;return i=new RegExp("(-)?([0-9]*):([0-9]*):?([0-9]*)?"),r=i.exec(e),s=r?function(){var e,t,i,s;i=r.slice(2),s=[];for(e=0,t=i.length;e<t;e++)n=i[e],s.push(parseInt(n,10));return s}():[0,0,0],t=r&&r[1]==="-",s.splice(0,0,t),s},ParseTime:function(e){var t,n,r,i,s;return i=new RegExp("(\\d*)\\:(\\d*)([wsugz]?)"),n=i.exec(e),n?(s=function(){var e,r,i,s;i=n.slice(1,3),s=[];for(e=0,r=i.length;e<r;e++)t=i[e],s.push(parseInt(t,10));return s}(),r=n[3]?n[3]:"",s.push(r),s):[0,0,""]},ApplyOffset:function(e,n,r){var i;return i=t.inHour*n.hours+t.inMinute*n.mins+t.inSecond*n.secs,n.negative&&(i*=-1),r&&(i*=-1),this.MakeDateFromTimeStamp(e.getTime()+i)},ApplySave:function(e,t){return this.ApplyOffset(e,{negative:!1,hours:t.hours,mins:t.mins,secs:0})},UTCToWallTime:function(e,t,n){var r;return r=this.UTCToStandardTime(e,t),this.ApplySave(r,n)},UTCToStandardTime:function(e,t){return this.ApplyOffset(e,t)},UTCToQualifiedTime:function(e,t,n,r){var i;i=e;switch(t){case"w":i=this.UTCToWallTime(i,n,r());break;case"s":i=this.UTCToStandardTime(i,n)}return i},StandardTimeToUTC:function(e,t,n,r,i,s,o,u){var a;return n==null&&(n=0),r==null&&(r=1),i==null&&(i=0),s==null&&(s=0),o==null&&(o=0),u==null&&(u=0),a=this.MakeDateFromParts(t,n,r,i,s,o,u),this.ApplyOffset(a,e)},MakeDateFromParts:function(e,t,n,r,i,s,o){var u;return t==null&&(t=0),n==null&&(n=1),r==null&&(r=0),i==null&&(i=0),s==null&&(s=0),o==null&&(o=0),Date.UTC?new Date(Date.UTC(e,t,n,r,i,s,o)):(u=new Date,u.setUTCFullYear(e),u.setUTCMonth(t),u.setUTCDate(n),u.setUTCHours(r),u.setUTCMinutes(i),u.setUTCSeconds(s),u.setUTCMilliseconds(o),u)},MakeDateFromTimeStamp:function(e){return new Date(e)},MaxDate:function(){return this.MakeDateFromTimeStamp(864e12)},MinDate:function(){return this.MakeDateFromTimeStamp(-864e12)}},i={Days:e,Months:n,Time:r,noSave:{hours:0,mins:0},noZone:{offset:{negative:!1,hours:0,mins:0,secs:0},name:"UTC"}},typeof window=="undefined"?module.exports=i:typeof define!="undefined"?define("olson/helpers",[],i):(this.WallTime||(this.WallTime={}),this.WallTime.helpers=i)}).call(this),function(){var e,t;e=function(e){var t;return t=function(){function t(t,n,r){this.utc=t,this.zone=n,this.save=r,this.offset=this.zone.offset,this.wallTime=e.Time.UTCToWallTime(this.utc,this.zone.offset,this.save)}return t.prototype.getFullYear=function(){return this.wallTime.getUTCFullYear()},t.prototype.getMonth=function(){return this.wallTime.getUTCMonth()},t.prototype.getDate=function(){return this.wallTime.getUTCDate()},t.prototype.getDay=function(){return this.wallTime.getUTCDay()},t.prototype.getHours=function(){return this.wallTime.getUTCHours()},t.prototype.getMinutes=function(){return this.wallTime.getUTCMinutes()},t.prototype.getSeconds=function(){return this.wallTime.getUTCSeconds()},t.prototype.getMilliseconds=function(){return this.wallTime.getUTCMilliseconds()},t.prototype.getTime=function(){return this.wallTime.getTime()},t}(),t},typeof window=="undefined"?(t=require("./helpers"),module.exports=e(t)):typeof define!="undefined"?define("olson/TimeZoneTime",["olson/helpers"],"TimeZoneTime",e):(this.WallTime||(this.WallTime={}),this.WallTime.TimeZoneTime=e(this.WallTime.helpers))}.call(this),function(){var e,t,n,r={}.hasOwnProperty;e=function(e,t){var n,i,s,o,u,a;return s=function(){function e(){}return e.prototype.applies=function(e){return!isNaN(parseInt(e,10))},e.prototype.parseDate=function(e){return parseInt(e,10)},e}(),i=function(){function t(){}return t.prototype.applies=function(e){return e.slice(0,4)==="last"},t.prototype.parseDate=function(t,n,r,i,s,o){var u,a,f;a=t.slice(4),u=e.Days.DayIndex(a),r<11?f=e.Time.MakeDateFromParts(n,r+1):f=e.Time.MakeDateFromParts(n+1,0),f=e.Days.AddToDate(f,-1);while(f.getUTCDay()!==u)f=e.Days.AddToDate(f,-1);return f.getUTCDate()},t}(),n=function(){function t(){}return t.prototype._onCompareRuleMatch=new RegExp("([a-zA-Z]*)([\\<\\>]?=)([0-9]*)"),t.prototype.applies=function(e){return e.indexOf(">")>-1||e.indexOf("<")>-1||e.indexOf("=")>-1},t.prototype.parseDate=function(t,n,r,i,s,o){var u,a,f,l,c,h,p,d,v;h=this._onCompareRuleMatch.exec(t);if(!h)throw new Error("Unable to parse the 'on' rule for "+t);v=h.slice(1,4),c=v[0],d=v[1],f=v[2],f=parseInt(f,10);if(f===NaN)throw new Error("Unable to parse the dateIndex of the 'on' rule for "+t);l=e.Days.DayIndex(c),a={">=":function(e,t){return e>=t},"<=":function(e,t){return e<=t},">":function(e,t){return e>t},"<":function(e,t){return e<t},"=":function(e,t){return e===t}},u=a[d];if(!u)throw new Error("Unable to parse the conditional for "+d);p=e.Time.MakeDateFromParts(n,r);while(l!==p.getUTCDay()||!u(p.getUTCDate(),f))p=e.Days.AddToDate(p,1);return p.getUTCDate()},t}(),o=function(){function t(t,n,r,i,s,o,u,a,f){var l,c,h,p;this.name=t,this._from=n,this._to=r,this.type=i,this["in"]=s,this.on=o,this.at=u,this._save=a,this.letter=f,this.from=parseInt(this._from,10),this.isMax=!1,h=this.from;switch(this._to){case"max":h=e.Time.MaxDate().getUTCFullYear(),this.isMax=!0;break;case"only":h=this.from;break;default:h=parseInt(this._to,10)}this.to=h,p=this._parseTime(this._save),l=p[0],c=p[1],this.save={hours:l,mins:c}}return t.prototype.forZone=function(t){return this.offset=t,this.fromUTC=e.Time.MakeDateFromParts(this.from,0,1,0,0,0),this.fromUTC=e.Time.ApplyOffset(this.fromUTC,t),this.toUTC=e.Time.MakeDateFromParts(this.to,11,31,23,59,59,999),this.toUTC=e.Time.ApplyOffset(this.toUTC,t)},t.prototype.setOnUTC=function(t,n,r){var i,s,o,u,a,f,l,c=this;return f=e.Months.MonthIndex(this["in"]),s=parseInt(this.on,10),o=isNaN(s)?this._parseOnDay(this.on,t,f):s,l=this._parseTime(this.at),u=l[0],a=l[1],i=l[2],this.onUTC=e.Time.MakeDateFromParts(t,f,o,u,a),this.onUTC.setUTCMilliseconds(this.onUTC.getUTCMilliseconds()-1),this.atQualifier=i!==""?i:"w",this.onUTC=e.Time.UTCToQualifiedTime(this.onUTC,this.atQualifier,n,function(){return r(c)}),this.onSort=""+f+"-"+o+"-"+this.onUTC.getUTCHours()+"-"+this.onUTC.getUTCMinutes()},t.prototype.appliesToUTC=function(e){return this.fromUTC<=e&&e<=this.toUTC},t.prototype._parseOnDay=function(e,t,r){var o,u,a,f;u=[new s,new i,new n];for(a=0,f=u.length;a<f;a++){o=u[a];if(!o.applies(e))continue;return o.parseDate(e,t,r)}throw new Error("Unable to parse 'on' field for "+this.name+"|"+this._from+"|"+this._to+"|"+e)},t.prototype._parseTime=function(t){return e.Time.ParseTime(t)},t}(),u=function(){function n(t,n){var i,s,o,u,a,f,l,c,h,p,d=this;this.rules=t,this.timeZone=n,u=0,f=null,a=null,o={},i={},p=this.rules;for(c=0,h=p.length;c<h;c++){l=p[c],l.forZone(this.timeZone.offset,function(){return e.noSave});if(f===null||l.from<f)f=l.from;if(a===null||l.to>a)a=l.to;o[l.to]=o[l.to]||[],o[l.to].push(l),i[l.from]=i[l.from]||[],i[l.from].push(l),u++}this.minYear=f,this.maxYear=a,s=function(n,i){var s,u,a,f;n==null&&(n="toUTC"),i==null&&(i=o),f=[];for(u in i){if(!r.call(i,u))continue;t=i[u],a=d.allThatAppliesTo(t[0][n]);if(a.length<1)continue;t=d._sortRulesByOnTime(t),s=a.slice(-1)[0];if(s.save.hours===0&&s.save.mins===0)continue;f.push(function(){var r,i,o;o=[];for(r=0,i=t.length;r<i;r++)l=t[r],o.push(l[n]=e.Time.ApplySave(l[n],s.save));return o}())}return f},s("toUTC",o),s("fromUTC",i)}return n.prototype.allThatAppliesTo=function(e){var t,n,r,i,s;i=this.rules,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],t.appliesToUTC(e)&&s.push(t);return s},n.prototype.getWallTimeForUTC=function(n){var r,i,s,o,u,a,f;u=this.allThatAppliesTo(n);if(u.length<1)return new t(n,this.timeZone,e.noSave);u=this._sortRulesByOnTime(u),i=function(t){var n;return n=u.indexOf(t),n<1?e.noSave:u[n-1].save};for(a=0,f=u.length;a<f;a++)o=u[a],o.setOnUTC(n.getUTCFullYear(),this.timeZone.offset,i);return r=function(){var e,t,r;r=[];for(e=0,t=u.length;e<t;e++)o=u[e],o.onUTC.getTime()<n.getTime()&&r.push(o);return r}(),s=e.noSave,r.length>0&&(s=r.slice(-1)[0].save),new t(n,this.timeZone,s)},n.prototype._sortRulesByOnTime=function(t){return t.sort(function(t,n){return e.Months.MonthIndex(t["in"])-e.Months.MonthIndex(n["in"])})},n}(),a={Rule:o,RuleSet:u,OnFieldHandlers:{NumberHandler:s,LastHandler:i,CompareHandler:n}},a},typeof window=="undefined"?(n=require("./helpers"),t=require("./timezonetime"),module.exports=e(n,t)):typeof define!="undefined"?define("olson/rule",["olson/helpers","olson/TimeZoneTime"],e):(this.WallTime||(this.WallTime={}),this.WallTime.rule=e(this.WallTime.helpers,this.WallTime.TimeZoneTime))}.call(this),function(){var e,t,n,r;e=function(e,t,n){var r,i,s;return r=function(){function r(t,n,r,i,s,o){var u,a,f,l,c,h;this.name=t,this._offset=n,this._rule=r,this.format=i,this._until=s,h=e.Time.ParseGMTOffset(this._offset),a=h[0],f=h[1],l=h[2],c=h[3],this.offset={negative:a,hours:f,mins:l,secs:isNaN(c)?0:c},u=o?e.Time.MakeDateFromTimeStamp(o.range.end.getTime()+1):e.Time.MinDate(),this.range={begin:u,end:this._parseUntilDate(this._until)}}return r.prototype._parseUntilDate=function(t){var n,r,i,s,o,u,a,f,l,c,h,p,d;return p=t.split(" "),h=p[0],u=p[1],n=p[2],c=p[3],d=c?e.Time.ParseGMTOffset(c):[!1,0,0,0],a=d[0],i=d[1],s=d[2],f=d[3],f=isNaN(f)?0:f,!h||h===""?e.Time.MaxDate():(h=parseInt(h,10),o=u?e.Months.MonthIndex(u):0,n=n?parseInt(n,10):0,l=e.Time.StandardTimeToUTC(this.offset,h,o,n,i,s,f),r=e.Time.MakeDateFromTimeStamp(l.getTime()-1),r)},r.prototype.UTCToWallTime=function(r,i){var s,o,u,a;return this._rule==="-"||this._rule===""?new n(r,this,e.noSave):this._rule.indexOf(":")>=0?(a=e.Time.ParseTime(this._rule),s=a[0],o=a[1],new n(r,this,{hours:s,mins:o})):(u=new t.RuleSet(i(this._rule),this),u.getWallTimeForUTC(r))},r}(),i=function(){function t(e,t){this.zones=e!=null?e:[],this.getRulesNamed=t,this.zones.length>0?this.name=this.zones[0].name:this.name=""}return t.prototype.add=function(e){this.zones.length===0&&this.name===""&&(this.name=e.name);if(this.name!==e.name)throw new Error("Cannot add different named zones to a ZoneSet");return this.zones.push(e)},t.prototype.findApplicable=function(e){var t,n,r,i,s,o;n=e.getTime(),t=null,o=this.zones;for(i=0,s=o.length;i<s;i++){r=o[i];if(r.range.begin.getTime()<=n&&n<=r.range.end.getTime()){t=r;break}}return t},t.prototype.getWallTimeForUTC=function(t){var r;return r=this.findApplicable(t),r?r.UTCToWallTime(t,this.getRulesNamed):new n(t,e.noZone,e.noSave)},t}(),s={Zone:r,ZoneSet:i}},typeof window=="undefined"?(n=require("./helpers"),r=require("./rule"),t=require("./timezonetime"),module.exports=e(n,r,t)):typeof define!="undefined"?define("olson/zone",["olson/helpers","olson/rule","olson/TimeZoneTime"],e):(this.WallTime||(this.WallTime={}),this.WallTime.zone=e(this.WallTime.helpers,this.WallTime.rule,this.WallTime.TimeZoneTime))}.call(this),function(){var e,t,n,r,i,s,o,u,a={}.hasOwnProperty;t=function(e){var t;return t=function(){function t(){}return t.prototype.init=function(e,t){return e==null&&(e=[]),t==null&&(t=[]),this.rules=e,this.zones=t,this.doneInit=!0},t.prototype.setTimeZone=function(t){var n,r=this;if(!this.doneInit)throw new Error("Must call init with rules and zones before setting time zone");if(!this.zones[t])throw new Error("Unable to find time zone named "+(t||"<blank>"));return n=this.zones[t],this.zoneSet=new e.ZoneSet(n.zones,function(e){return r.rules[e]}),this.timeZoneName=t},t.prototype.UTCToWallTime=function(e,t){t==null&&(t=this.timeZoneName);if(!this.zoneSet)throw new Error("Must set the time zone before converting times");return t!==this.timeZoneName&&this.setTimeZone(t),this.zoneSet.getWallTimeForUTC(e)},t}(),new t};if(typeof window=="undefined")r=require("./olson/zone"),module.exports=t(r);else if(typeof define!="undefined")define("walltime",["olson/zone"],t);else{this.WallTime||(this.WallTime={}),e=t(this.WallTime.zone),s=this.WallTime;for(n in s){if(!a.call(s,n))continue;i=s[n],e[n]=i}this.WallTime=e,this.WallTime.autoinit&&((o=this.WallTime.data)!=null?o.rules:void 0)&&((u=this.WallTime.data)!=null?u.zoneSet:void 0)&&this.WallTime.init(this.WallTime.data.rules,this.WallTime.data.zones)}}.call(this)